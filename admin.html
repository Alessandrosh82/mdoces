<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Admin - MDoces</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --indigo: #3f51b5;
      --indigo-dark: #303f9f;
      --light: #f5f5f5;
      --gray: #888;
      --white: #fff;
      --green: #25d366;
      --red: #e53935;
      --radius: 12px;
    }
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: 'Inter', sans-serif;
    }
    body {
      background-color: var(--light);
      padding: 2rem;
      color: #333;
    }
    .container {
      max-width: 960px;
      margin: auto;
      background: var(--white);
      border-radius: var(--radius);
      box-shadow: 0 4px 16px rgba(0,0,0,0.08);
      padding: 2rem;
    }
    .login-screen {
      max-width: 400px;
      margin: 5rem auto;
      padding: 2rem;
      background: white;
      border-radius: 12px;
      box-shadow: 0 0 20px rgba(0,0,0,0.1);
      text-align: center;
    }
    .login-screen input {
      width: 100%;
      padding: 0.7rem;
      margin: 1rem 0;
      border: 1px solid #ccc;
      border-radius: 8px;
      font-size: 1rem;
    }
    .login-screen button {
      padding: 0.7rem 1.5rem;
      background: var(--indigo);
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 1rem;
      cursor: pointer;
    }
    .hidden {
      display: none;
    }
    h1 {
      font-size: 1.8rem;
      color: var(--indigo);
      margin-bottom: 1rem;
    }
    .section {
      margin-bottom: 2rem;
    }
    label {
      font-weight: 600;
      display: block;
      margin-top: 1rem;
    }
    input, textarea, select {
      width: 100%;
      padding: 0.6rem;
      margin-top: 0.4rem;
      border: 1px solid #ccc;
      border-radius: 6px;
      font-size: 1rem;
    }
    textarea {
      resize: vertical;
      min-height: 60px;
    }
    button {
      margin-top: 1rem;
      padding: 0.6rem 1.2rem;
      font-weight: 600;
      color: var(--white);
      background: var(--indigo);
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
    button:hover {
      background: var(--indigo-dark);
    }
    .btn-delete {
      background: var(--red);
      margin-left: 0.5rem;
    }
    .product-list, .order-list {
      margin-top: 1rem;
      background: #fafafa;
      border-radius: 6px;
      border: 1px solid #ddd;
      padding: 1rem;
    }
    .item {
      padding: 0.6rem 0;
      border-bottom: 1px solid #eee;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .item:last-child {
      border-bottom: none;
    }
    .item span {
      flex: 1;
    }
    .whatsapp {
      background: #e8f5e9;
      padding: 1rem;
      border: 1.5px solid var(--green);
      border-radius: var(--radius);
    }
    .status-select {
      margin-left: 1rem;
    }
  </style>
</head>
<body>
  <div id="login" class="login-screen">
    <h2>Área Administrativa</h2>
    <p>Digite a senha para acessar:</p>
    <input type="password" id="adminPassword" placeholder="Senha" />
    <button onclick="checkPassword()">Entrar</button>
    <p id="loginError" style="color: red; display: none;">Senha incorreta!</p>
  </div>

  <div id="adminPanel" class="container hidden">
    <h1>Administração MDoces</h1>

    <div class="section">
      <h2>Cadastro / Edição de Produtos</h2>
      <label>Nome</label>
      <input id="nome">
      <label>Descrição</label>
      <textarea id="descricao"></textarea>
      <label>Preço (R$)</label>
      <input id="preco" type="number" min="0" step="0.01">
      <label>Categoria</label>
      <select id="categoria">
        <option value="">Selecione</option>
        <option value="bolos">Bolos</option>
        <option value="docinhos">Docinhos</option>
        <option value="salgados">Salgados</option>
        <option value="bebidas">Bebidas</option>
      </select>
      <label>Imagem (URL)</label>
      <input id="imagem" type="url">
      <button onclick="salvarProduto()">Salvar Produto</button>
    </div>

    <div class="section">
      <h2>Produtos Cadastrados</h2>
      <div class="product-list" id="produtos-lista"></div>
    </div>

    <div class="section whatsapp">
      <label>Número do WhatsApp</label>
      <input id="whatsapp" placeholder="Ex: 11999998888">
      <button onclick="salvarWhatsapp()">Salvar</button>
    </div>

    <div class="section">
      <h2>Pedidos Recebidos</h2>
      <div class="order-list" id="pedidos-lista"></div>
    </div>
  </div>

  <script>
    const senhaCorreta = "mdoces123";

    function checkPassword() {
      const senhaDigitada = document.getElementById("adminPassword").value;
      const erro = document.getElementById("loginError");
      if (senhaDigitada === senhaCorreta) {
        document.getElementById("login").classList.add("hidden");
        document.getElementById("adminPanel").classList.remove("hidden");
        listarProdutos();
        listarPedidos();
        document.getElementById("whatsapp").value = localStorage.getItem("whatsapp") || "";
      } else {
        erro.style.display = "block";
      }
    }

    let produtos = JSON.parse(localStorage.getItem("produtos") || "[]");
    let pedidos = JSON.parse(localStorage.getItem("pedidos") || "[]");

    function salvarProduto() {
      const nome = document.getElementById("nome").value.trim();
      const descricao = document.getElementById("descricao").value.trim();
      const preco = parseFloat(document.getElementById("preco").value);
      const categoria = document.getElementById("categoria").value;
      const imagem = document.getElementById("imagem").value.trim();

      if (!nome || !descricao || !categoria || !imagem || isNaN(preco)) {
        return alert("Preencha todos os campos corretamente.");
      }

      const i = produtos.findIndex(p => p.nome === nome);
      if (i >= 0) produtos[i] = { nome, descricao, preco, categoria, imagem };
      else produtos.push({ nome, descricao, preco, categoria, imagem });

      localStorage.setItem("produtos", JSON.stringify(produtos));
      listarProdutos();
    }

    function listarProdutos() {
      const lista = document.getElementById("produtos-lista");
      lista.innerHTML = produtos.map((p, i) => `
        <div class="item">
          <span>${p.nome}</span>
          <div>
            <button onclick="editarProduto(${i})">Editar</button>
            <button class="btn-delete" onclick="excluirProduto(${i})">Excluir</button>
          </div>
        </div>`).join("");
    }

    function editarProduto(i) {
      const p = produtos[i];
      document.getElementById("nome").value = p.nome;
      document.getElementById("descricao").value = p.descricao;
      document.getElementById("preco").value = p.preco;
      document.getElementById("categoria").value = p.categoria;
      document.getElementById("imagem").value = p.imagem;
    }

    function excluirProduto(i) {
      if (confirm("Excluir produto?")) {
        produtos.splice(i, 1);
        localStorage.setItem("produtos", JSON.stringify(produtos));
        listarProdutos();
      }
    }

    function salvarWhatsapp() {
      const numero = document.getElementById("whatsapp").value.trim();
      if (!/^\d{10,13}$/.test(numero)) return alert("Número inválido.");
      localStorage.setItem("whatsapp", numero);
      alert("WhatsApp salvo.");
    }

    function listarPedidos() {
      const lista = document.getElementById("pedidos-lista");
      lista.innerHTML = pedidos.map((p, i) => `
        <div class="item">
          <span><strong>${p.nomeCliente}</strong> - ${p.itens.join(", ")} - <em>${p.status}</em></span>
          <select class="status-select" onchange="atualizarStatus(${i}, this.value)">
            <option value="Pendente" ${p.status === "Pendente" ? "selected" : ""}>Pendente</option>
            <option value="Em preparo" ${p.status === "Em preparo" ? "selected" : ""}>Em preparo</option>
            <option value="Pronto" ${p.status === "Pronto" ? "selected" : ""}>Pronto</option>
            <option value="Enviado" ${p.status === "Enviado" ? "selected" : ""}>Enviado</option>
          </select>
        </div>`).join("");
    }

    function atualizarStatus(i, status) {
      pedidos[i].status = status;
      localStorage.setItem("pedidos", JSON.stringify(pedidos));
      listarPedidos();
    }
  </script>
</body>
</html>
